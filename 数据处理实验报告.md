# 数据处理实验报告

## 1.	Dataset1-Airquality

数据集描述：https://archive.ics.uci.edu/ml/datasets/Air+quality

### 1.1	数据读取&缺失值处理

- 缺失值：按列取平均值（<u>注意 先将-200去掉才能取平均</u>）
- 划分训练集&测试集：sklearn中train_test_split模块，按2：1划分，random_state=42或0

### 1.2	Linear Regression

- 不考虑1~2列（时间），取2~14列作为X input，第15列作为结果y output。
- 训练模型，训练集上sccore=0.9093325860275768
- 测试集上score=0.9118388723227883
- 查看参数![1558725328648](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558725328648.png)

## 2.	Dataset2-Bluetooth RSSI（iBeacon）

数据集描述：https://archive.ics.uci.edu/ml/datasets/BLE+RSSI+Dataset+for+Indoor+localization+and+Navigation

### 2.1	数据读取&缺失值处理

- 缺失值处理：由于缺失值含义是"out of range"或检测时处于信号发射间隔（接收不到），所以将时间的影响计入，即将时间转化为时间戳格式输入；同时"out of range"对应负无穷，由于负无穷无法为模型接收，将所有的数据值+200，使原-200的数值变成0即无穷小量。
- 降维：运用tSNE模块，将所有数据降至3维，以便聚类算法后可视化。
- 划分训练集&测试集：sklearn中train_test_split模块，按2：1划分，random_state=42或0。

### 2.2	classification：

在labled数据集上实现分类（有监督学习）。

#### 2.2.1	SVM

- 训练模型：![1558880191826](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880191826.png)

  经过多次实验挑选参数Cost=3。

- 测试集上测试：

  ![1558880331440](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880331440.png)

#### 2.2.2	dicision tree

- 训练模型：![1558880629930](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880629930.png)

- 测试集上测试：![1558880609002](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880609002.png)

  结果可以说非常不理想。期间尝试过改变预处理方法、调参等，无改善；也许将数据集划分成块会有帮助，但操作繁琐且提高了复杂度。

#### 2.2.3	random forest

- 训练模型：![1558880684866](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880684866.png)

- 测试集上测试：![1558880702510](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558880702510.png)

  结果较决策树理想一些。。。但依然不佳

### 2.3	clustering：

在unlabled数据集上实现聚类（无监督学习）。

#### 2.3.1 	DBScan

- 训练模型：![1558881102510](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881102510.png)

  参数经过手动试验调整。

- 聚类可视化：

  ![1558881160004](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881160004.png)

  形成共53个类簇。

#### 2.3.2	K-Means

- 选取最佳超参k:

  - "手肘法"

    让k从1开始取值直到取到你认为合适的上限(一般来说这个上限不会太大，这里我们选取上限为8)，对每一个k值进行聚类并且记下对于的SSE，然后画出k和SSE的关系图（毫无疑问是手肘形），最后选取肘部对应的k作为我们的最佳聚类数。![1558881360619](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881360619.png)

  - 轮廓系数法

    该方法的核心指标是轮廓系数（Silhouette Coefficient），某个样本点Xi的轮廓系数定义如下：                                               
    ![1558881443780](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881443780.png)
    其中，a是Xi与同簇的其他样本的平均距离，称为凝聚度，b是Xi与最近簇中所有样本的平均距离，称为分离度。而最近簇的定义是
    ![1558881464791](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881464791.png)
    其中p是某个簇Ck中的样本。事实上，简单点讲，就是用Xi到某个簇所有样本平均距离作为衡量该点到该簇的距离后，选择离Xi最近的一个簇作为最近簇。
        求出所有样本的轮廓系数后再求平均值就得到了平均轮廓系数。平均轮廓系数的取值范围为[-1,1]，且簇内样本的距离越近，簇间样本距离越远，平均轮廓系数越大，聚类效果越好。那么，很自然地，平均轮廓系数最大的k便是最佳聚类数。![1558881500188](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881500188.png)

  - 综上两法选取k值

    可以看到，轮廓系数最大的k值是3，这表示我们的最佳聚类数为3。但是，值得注意的是，在k和SSE的手肘图中，也可能k取3时，SSE还非常大，这是k就是一个不太合理的聚类数，我们退而求其次，可以考虑轮廓系数第二大的k值k'，这时候SSE已经处于一个较低的水平，因此最佳聚类系数应该取k'而不是k。

    <u>**补充**：</u>理论上k时轮廓系数最大，聚类效果应该非常好，那为什么SSE会这么大呢？在我看来，原因在于轮廓系数考虑了分离度b，也就是样本与最近簇中所有样本的平均距离。为什么这么说，因为从定义上看，轮廓系数大，不一定是凝聚度a（样本与同簇的其他样本的平均距离）小，而可能是b和a都很大的情况下b相对a大得多，这么一来，a是有可能取得比较大的。a一大，样本与同簇的其他样本的平均距离就大，簇的紧凑程度就弱，那么簇内样本离质心的距离也大，从而导致SSE较大。所以，虽然轮廓系数引入了分离度b而限制了聚类划分的程度，但是同样会引来最优结果的SSE比较大的问题，这一点也是值得注意的。

- 训练模型：

  ![1558881626382](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881626382.png)

  其中选择了”k-means++“的方法优化。

- 聚类可视化：

  ![1558881654650](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881654650.png)

#### 2.3.3	GMM（高斯混合模型）

- 训练模型:

  ![1558881739237](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881739237.png)

- 聚类可视化：

  ![1558881759455](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881759455.png)

#### 2.3.4	层次聚类

- 确定超参n_cluster：

  虽然有找到基于层次划分的最佳聚类数确定方法paper：<http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.522.5834&rep=rep1&type=pdf> 

  但不是很看得懂。。。所以沿用了k-means聚类中最优k值3。

- 训练模型：![1558881906794](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881906794.png)

- 聚类可视化：

  ![1558881973083](C:\Users\LEN\AppData\Roaming\Typora\typora-user-images\1558881973083.png)